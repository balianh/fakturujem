<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Faktura</title>
    </h:head>

    <h:body>

        <h:form>
            <p:commandButton action="dashboard.xhtml" ajax="true"  value="Zpět na přehled">
                <f:actionListener binding="#{invoiceBean.flushForm()}" />
            </p:commandButton> 
            <p:commandButton value="Import" />
        </h:form>

        <h:form id="form">

            <p:panel id="invoice" header="Faktura" style="width: 1080px;">

                <p:messages id="globalError" closable="true" />

                <p:fieldset id="head" legend="Hlavička" toggleable="true" toggleSpeed="500" style=" width: 1005px;">

                    <p:messages id="detailsError" closable="true" />

                    <h:panelGrid id="details" columns="3"  cellpadding="5" >

                        <p:outputLabel for="created" value="Datum vystavení:"/>
                        <p:outputLabel for="duzp" value="DUZP:"/>
                        <p:outputLabel for="due" value="Splatnost:"/>    
                        <p:calendar id="created" locale="cs" value="#{invoiceBean.created}" showOn="button" required="true" label="Datum vystavení" />                  
                        <p:calendar id="duzp" locale="cs" value="#{invoiceBean.duzp}" required="true" showOn="button" label="DUZP"/>
                        <p:calendar id="due" locale="cs" value="#{invoiceBean.due}" required="true" showOn="button" label="Splatnost"/>                


                        <p:outputLabel value="Forma platby:" for="method" />
                        <p:outputLabel for="invoiceNumber" value="Číslo faktury:"/>
                        <p:outputLabel for="singleContact" value="Odběratel je i příjemcem:" />
                        <p:autoComplete id="method" dropdown="true" required="true" value="#{invoiceBean.method}" completeMethod="#{invoiceBean.completeMethod}" />                 
                        <p:inputText id="invoiceNumber" value="#{invoiceBean.invoiceNumber}" required="false" label="Číslo faktury"/>
                        <p:selectBooleanButton id="singleContact" value="#{invoiceBean.singleContact}" onLabel="Ano" offLabel="Ne" onIcon="ui-icon-check" offIcon="ui-icon-close" style="width: 90px">
                            <p:ajax listener="#{invoiceBean.toggleRecipientView}" />
                        </p:selectBooleanButton>

                    </h:panelGrid>
                    
                    <p:fieldset id="recipientFields" legend="Příjemce" toggleable="true" toggleSpeed="500" style="float: right; width: 460px;">

                        <p:messages id="recipientError" closable="true" />

                        <h:panelGrid id="recipientGrid" columns="2" cellpadding="5">

                            <p:outputLabel value="Vyhledat:" for="recipient" />
                            <p:autoComplete id="recipient" value="#{invoiceBean.recipient}" completeMethod="#{invoiceBean.completeContact}"
                                            var="person" itemLabel="#{person.wholename}" itemValue="#{person}" converter="personConverter" forceSelection="true" dropdown="true"  />

                            <p:outputLabel for="recipientName" value="Jméno:" />                   
                            <p:inputText id="recipientName" value="#{invoiceBean.recipient.name}" required="false" label="Jméno" validatorMessage="Chyba" />

                            <p:outputLabel for="recipientLastName" value="Příjmení:" />                   
                            <p:inputText id="recipientLastName" value="#{invoiceBean.recipient.lastname}" required="false" label="Příjmení" validatorMessage="Chyba" />

                            <p:outputLabel for="recipientCompany" value="Firma:" />                   
                            <p:inputText id="recipientCompany" value="#{invoiceBean.recipient.company}" required="false" label="Firma" validatorMessage="Chyba" />

                            <p:outputLabel for="recipientIco" value="IČO:" />                   
                            <p:inputMask mask="99999999" id="recipientIco" value="#{invoiceBean.recipient.ico}" required="false" label="IČO" validatorMessage="Chyba" />

                            <p:outputLabel for="recipientCity" value="Město:" />                   
                            <p:inputText id="recipientCity" value="#{invoiceBean.recipient.city}" required="false" label="Město" validatorMessage="Chyba"/>

                            <p:outputLabel for="recipientPcode" value="PSČ:" />                   
                            <p:inputMask mask="99999" id="recipientPcode" value="#{invoiceBean.recipient.pcode}" required="false" label="PSČ" validatorMessage="Chyba: PSČ musí být pětimístné číslo např. 37001"/>

                            <p:outputLabel for="recipientStreet" value="Ulice:"/>                   
                            <p:inputText id="recipientStreet" value="#{invoiceBean.recipient.street}" required="false" label="Ulice" validatorMessage="Chyba"/>

                            <p:outputLabel for="recipientHouse" value="Číslo domu:"/>                   
                            <p:inputText id="recipientHouse" value="#{invoiceBean.recipient.house}" required="false" label="Číslo domu" validatorMessage="Chyba"/>

                            <p:outputLabel for="recipientEmail" value="E-mail:"/>                   
                            <p:inputText id="recipientEmail" value="#{invoiceBean.recipient.email}" required="false" label="E-mail" validatorMessage="Chyba"/>

                            <p:outputLabel for="recipientPhone" value="Telefon:"/>                   
                            <p:inputMask mask="999 999 999" id="recipientPhone" value="#{invoiceBean.recipient.phone}" required="false" label="Telefon" validatorMessage="Chyba"/>

                            <p:outputLabel />
                            <p:commandButton value="Vytvořit" validateClient="true" process="recipientGrid" update="recipientGrid recipientError" icon="ui-icon-disk" />

                        </h:panelGrid>

                    </p:fieldset>


                    <p:fieldset id="customerFields" legend="Odběratel" toggleable="true" toggleSpeed="500" style="width: 460px;">

                        <p:messages id="customerError" closable="true" />

                        <h:panelGrid id="customerGrid" columns="2" cellpadding="5">

                            <p:outputLabel value="Vyhledat:" for="customer" />
                            <p:autoComplete id="customer" value="#{invoiceBean.customer}" completeMethod="#{invoiceBean.completeContact}"
                                            var="person" itemLabel="#{person.wholename}" itemValue="#{person}" converter="personConverter" forceSelection="true" dropdown="true"  />

                            <p:outputLabel for="customerName" value="Jméno:" />                   
                            <p:inputText id="customerName" value="#{invoiceBean.customer.name}" required="false" label="Jméno" validatorMessage="Chyba" />

                            <p:outputLabel for="customerLastName" value="Příjmení:" />                   
                            <p:inputText id="customerLastName" value="#{invoiceBean.customer.lastname}" required="false" label="Příjmení" validatorMessage="Chyba" />

                            <p:outputLabel for="customerCompany" value="Firma:" />                   
                            <p:inputText id="customerCompany" value="#{invoiceBean.customer.company}" required="false" label="Firma" validatorMessage="Chyba" />

                            <p:outputLabel for="customerIco" value="IČO:" />                   
                            <p:inputMask mask="99999999" id="customerIco" value="#{invoiceBean.customer.ico}" required="false" label="IČO" validatorMessage="Chyba" />

                            <p:outputLabel for="customerCity" value="Město:" />                   
                            <p:inputText  id="customerCity" value="#{invoiceBean.customer.city}" required="false" label="Město" validatorMessage="Chyba"/>

                            <p:outputLabel for="customerPcode" value="PSČ:" />                   
                            <p:inputMask mask="99999" id="customerPcode" value="#{invoiceBean.customer.pcode}" required="false" label="PSČ" validatorMessage="Chyba: PSČ musí být pětimístné číslo např. 37001"/>

                            <p:outputLabel for="customerStreet" value="Ulice:"/>                   
                            <p:inputText id="customerStreet" value="#{invoiceBean.customer.street}" required="false" label="Ulice" validatorMessage="Chyba"/>

                            <p:outputLabel for="customerHouse" value="Číslo domu:"/>                   
                            <p:inputText id="customerHouse" value="#{invoiceBean.customer.house}" required="false" label="Číslo domu" validatorMessage="Chyba"/>

                            <p:outputLabel for="customerEmail" value="E-mail:"/>                   
                            <p:inputText id="customerEmail" value="#{invoiceBean.customer.email}" required="false" label="E-mail" validatorMessage="Chyba"/>

                            <p:outputLabel for="customerPhone" value="Telefon:"/>                   
                            <p:inputMask mask="999 999 999" id="customerPhone" value="#{invoiceBean.customer.phone}" required="false" label="Telefon" validatorMessage="Chyba"/>

                            <p:outputLabel />
                            <p:commandButton value="Vytvořit" validateClient="true" process="customerGrid" update="customerGrid customerError" icon="ui-icon-disk" />

                        </h:panelGrid>

                    </p:fieldset>

                </p:fieldset>

                <h:form id="table">

                    <p:fieldset id="itemFields" legend="Položky" toggleable="true" toggleSpeed="500" style=" width: 1005px;">

                        <p:messages id="itemEror" closable="true"/>

                        <h:panelGrid id="itemGrid" columns="4" cellpadding="5" >

                            <p:outputLabel value="Položka:" for="inputTitle" />
                            <p:outputLabel for="inputPrice" value="Cena za kus:" />
                            <p:outputLabel for="inputAmount" value="Množství:"/>
                            <p:outputLabel />

                            <p:autoComplete id="inputTitle" dropdown="true" value="#{invoiceBean.item.title}" required="true" completeMethod="#{invoiceBean.completeItemTitle}" />
                            <p:spinner id="inputPrice" value="#{invoiceBean.item.price}" required="true" suffix=" Kč" min="0" />
                            <p:spinner id="inputAmount" value="#{invoiceBean.item.amount}" min="1" suffix=" ks" required="true" />
                            <p:commandButton process="itemGrid @parent items @parent" id="btnAdd" value="Přidat" update="items @parent itemEror @parent" action="#{invoiceBean.reinit}">
                                <p:collector value="#{invoiceBean.item}" addTo="#{invoiceBean.items}" unique="true"/>
                            </p:commandButton>

                        </h:panelGrid>

                        <p:outputPanel id="items">

                            <p:dataTable value="#{invoiceBean.items}" var="item" id="itemsTable">

                                <p:column headerText="Položka">
                                    <h:outputText value="#{item.title}" />
                                </p:column>

                                <p:column headerText="Cena za kus" width="150">
                                    <h:outputText value="#{item.price} Kč" />
                                </p:column>

                                <p:column headerText="Množství" width="150">
                                    <h:outputText value="#{item.amount} ks" />
                                </p:column>

                                <p:column headerText="Akce" width="50">
                                    <p:commandButton title="Odstranit" update=":form:table:items" process=":form:table:items" icon="ui-icon-trash">
                                        <p:collector value="#{item}" removeFrom="#{invoiceBean.items}" unique="true"/>
                                    </p:commandButton>
                                </p:column>

                            </p:dataTable>

                        </p:outputPanel>    

                    </p:fieldset>

                </h:form>

                <p:commandButton action="none" value="Uložit" process="details customerGrid recipientGrid" update="details customerGrid recipientGrid globalError" validateClient="true" icon="ui-icon-disk"/>

            </p:panel>
        </h:form>

    </h:body>

    <script type="text/javascript">
        PrimeFaces.locales ['cs'] = {
            closeText: 'Zavřít',
            prevText: 'Předchozí',
            nextText: 'Další', monthNames: ['Leden', 'Únor', 'Březen', 'Duben', 'Květen', 'Červen', 'Červenec', 'Srpen', 'Září', 'Říjen', 'Listopad', 'Prosinec'],
            monthNamesShort: ['Led', 'Ún', 'Bře', 'Dub', 'Kvě', 'Čer', 'Čerec', 'Srp', 'Zář', 'Říj', 'Lis', 'Pro'],
            dayNames: ['Neděle', 'Pondělí', 'Úterý', 'Středa', 'Čtvrtek', 'Pátek', 'Sobota'],
            dayNamesShort: ['Ne', 'Po', 'Út', 'Stř', 'Čt', 'Pá', 'So'],
            dayNamesMin: ['Ne', 'Po', 'Út', 'Stř', 'Čt', 'Pá', 'So'],
            weekHeader: 'Týden',
            firstDay: 1,
            isRTL: false,
            showMonthAfterYear: false,
            yearSuffix: '',
            timeOnlyTitle: 'Pouze čas',
            timeText: 'Čas',
            hourText: 'Hodina',
            minuteText: 'Minuta',
            secondText: 'Vteřina',
            currentText: 'Aktuální datum',
            ampm: false,
            month: 'Měsíc',
            week: 'týden',
            day: 'den',
            allDayText: 'Celý den'
        };
    </script>


</html>

